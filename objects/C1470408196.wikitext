{{SystemComponent
|HasEntityTitle=wiki.dataspectsSystem
|HasEntityBlurb='''wiki.dataspectsSystem''' is the '''primary platform''' to '''manage knowledge as connected entities''' organized by the principles of '''https://everypageispageone.com/the-book'''.
}}
dataspects recommends https://www.semantic-mediawiki.org as its wiki component.

== {{Property|CanBeInstalled|Yes}} ==

 {{code|{{my|'''Versioning'''}}}} | {{code|{{mlb|'''docker exec'''}}}}

=== Step 1: Prepare Docker containers and volumes ===

# [[C0169948125]]

=== Step 2: Get software and set permissions ===

# {{code|user@dockerserver:/var/lib/docker/volumes/<VOLUME>/_data$ '''git clone -b {{my|REL1_31}} --depth 1 --single-branch https://github.com/wikimedia/mediawiki.git w/'''}}
#* https://github.com/wikimedia/mediawiki/branches/active
# {{code|user@dockerserver:/var/lib/docker/volumes/<VOLUME>/_data/w$ '''git submodule update --init --recursive'''}}
# {{code|user@dockerserver:/var/lib/docker/volumes/<VOLUME>/_data/w$ '''chown -R www-data .'''}}
# Install PHP Composer: https://getcomposer.org/download/
#* {{code|user@dockerserver:~$ docker exec -it wikidataspectslocal_mediawikiservice_1 /bin/bash}}
# {{code|user@dockerserver:/var/lib/docker/volumes/<VOLUME>/_data/w$ '''{{mlb|docker exec}} --user www-data <container> bash -c "cd /var/www/html/w && php composer.phar install"'''}}
#* This will currently cause ''Cannot create cache directory /var/www/.composer/cache/repo/https---repo.packagist.org/, or directory is not writable. Proceeding without cache. Cannot create cache directory /var/www/.composer/cache/files/, or directory is not writable. Proceeding without cache.''

=== Step 3: Configure and run MediaWiki installation script ===

# Place a copy of https://github.com/dataspects/dataspectsSystem/blob/master/ansible_templates/install_mediawiki.sh.j2 as {{code|/var/lib/docker/volumes/<VOLUME>/_data/w/install_mediawiki.sh}}
# Configure {{code|/var/lib/docker/volumes/<VOLUME>/_data/w/install_mediawiki.sh}}
# {{code|user@dockerserver:/var/lib/docker/volumes/<VOLUME>/_data/w$ '''{{mlb|docker exec}} --user www-data <container> bash -c "cd /var/www/html/w && ./install_mediawiki.sh"'''}}

=== Step 4: Add fundamental settings to LocalSetting.php ===

:::<syntaxhighlight lang="php">
 $wgArticlePath = '/wiki/$1';
 $wgServer = "???";
 $wgEnableUploads = true;
</syntaxhighlight>

=== Step 5: Configure and run MediaWiki extensions installation ===

# Place copies of:
#* https://github.com/dataspects/dataspectsSystem/blob/master/ansible_templates/mediawiki_extensions.yml.j2 as {{code|/var/lib/docker/volumes/<VOLUME>/_data/w/mediawiki_extensions.yml}}
#* https://github.com/dataspects/dataspectsSystem/blob/master/ansible_templates/install_mediawiki_extensions.rb.j2 as {{code|/var/lib/docker/volumes/<VOLUME>/_data/w/install_mediawiki_extensions.rb}}
# Configure {{code|/var/lib/docker/volumes/<VOLUME>/_data/w/install_mediawiki_extensions.rb}}
#* https://github.com/wikimedia/mediawiki-extensions-VisualEditor/branches/active {{my|Version}}
#* https://packagist.org/packages/mediawiki/semantic-media-wiki {{my|Version}}
#* https://packagist.org/packages/mediawiki/semantic-result-formats {{my|Version}}
# {{code|user@dockerserver:/var/lib/docker/volumes/<VOLUME>/_data/w$ '''ruby install_mediawiki_extensions.rb'''}}

{{Context
|HasContext=C0169948125
}}
